
worker_processes  1;

events {
    worker_connections  1024;
}

http {
    lua_package_path '$prefix/../lib/?.lua;;';

    server {
        listen        8080;             
        server_name   localhost;
        default_type  application/octet-stream;

        access_log    logs/access.log;
        error_log     logs/error.log info;

        client_max_body_size  100m;

        location ~ "^/files/([^/]+)$" {
            content_by_lua_block {
                local upload = require "shuaicj.upload"
                upload.start({filename = ngx.var[1]})
            }
        }
    }
}
